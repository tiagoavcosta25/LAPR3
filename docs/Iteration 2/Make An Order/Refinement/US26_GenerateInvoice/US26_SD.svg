<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="619px" preserveAspectRatio="none" style="width:979px;height:619px;" version="1.1" viewBox="0 0 979 619" width="979px" zoomAndPan="magnify"><defs><filter height="300%" id="f1gonokwd7yz26" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="452.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="89.5703"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="54.2188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="129.9219"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="248.3594"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="60.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="342.9297"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="60.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="481.3359"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="712" y="373.2813"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="889.5" y="511.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="264" x2="264" y1="57.2188" y2="607.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="547.5" x2="547.5" y1="139.6797" y2="607.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="716.5" x2="716.5" y1="203.8984" y2="607.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="802.5" x2="802.5" y1="298.4688" y2="607.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="894.5" x2="894.5" y1="57.2188" y2="607.3906"/><rect fill="#FEFECE" filter="url(#f1gonokwd7yz26)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="180" x="172" y="20.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="166" x="179" y="42.1426">GenerateInvoiceController</text><rect fill="#FEFECE" filter="url(#f1gonokwd7yz26)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="94" x="845.5" y="20.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="852.5" y="42.1426">EmailSender</text><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="452.1172" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="259" y="89.5703"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="54.2188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="129.9219"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="248.3594"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="60.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="342.9297"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="60.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="543" y="481.3359"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="712" y="373.2813"/><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="889.5" y="511.6875"/><ellipse cx="10.5" cy="88.8203" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="247,85.5703,257,89.5703,247,93.5703,251,89.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="15" x2="253" y1="89.5703" y2="89.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="18" y="84.7139">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="29" y="84.7139">generateInvoice(order, mapPayments)</text><polygon fill="#A80036" points="479.5,115.9219,489.5,119.9219,479.5,123.9219,483.5,119.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="485.5" y1="119.9219" y2="119.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="276" y="115.0654">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="287" y="115.0654">create()</text><rect fill="#FEFECE" filter="url(#f1gonokwd7yz26)" height="49.2188" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="491.5" y="97.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="509.5" y="119.1035">invoiceServ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="498.5" y="136.7129">:InvoiceService</text><polygon fill="#A80036" points="662.5,180.1406,672.5,184.1406,662.5,188.1406,666.5,184.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="548" x2="668.5" y1="184.1406" y2="184.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="555" y="179.2842">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="566" y="179.2842">create()</text><rect fill="#FEFECE" filter="url(#f1gonokwd7yz26)" height="49.2188" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="674.5" y="161.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="683.5" y="183.3223">invoiceDB</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="681.5" y="200.9316">:InvoiceDB</text><polygon fill="#A80036" points="531,244.3594,541,248.3594,531,252.3594,535,248.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="537" y1="248.3594" y2="248.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="276" y="243.5029">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="287" y="243.5029">invoice = addInvoice(order, mapPayments)</text><polygon fill="#A80036" points="757.5,274.7109,767.5,278.7109,757.5,282.7109,761.5,278.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="548" x2="763.5" y1="278.7109" y2="278.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="555" y="273.8545">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="566" y="273.8545">create(order, mapPayments)</text><rect fill="#FEFECE" filter="url(#f1gonokwd7yz26)" height="49.2188" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="769.5" y="256.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="778.5" y="277.8926">invoice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="776.5" y="295.502">:Invoice</text><polygon fill="#A80036" points="531,338.9297,541,342.9297,531,346.9297,535,342.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="537" y1="342.9297" y2="342.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="276" y="338.0732">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="287" y="338.0732">registerInvoice(invoice)</text><polygon fill="#A80036" points="700,369.2813,710,373.2813,700,377.2813,704,373.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553" x2="706" y1="373.2813" y2="373.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="560" y="368.4248">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="571" y="368.4248">registerInvoice(invoice)</text><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="42.7031" style="stroke: #000000; stroke-width: 2.0;" width="126" x="671.5" y="411.2813"/><polygon fill="#EEEEEE" points="671.5,411.2813,733.5,411.2813,733.5,419.2813,723.5,429.2813,671.5,429.2813,671.5,411.2813" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="684.5" y="426.7764">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="677.5" y="446.7764">SD_CONNECTIONS</text><polygon fill="#A80036" points="531,477.3359,541,481.3359,531,485.3359,535,481.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="269" x2="537" y1="481.3359" y2="481.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="276" y="476.4795">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="287" y="476.4795">sendEmail(invoice)</text><polygon fill="#A80036" points="877.5,507.6875,887.5,511.6875,877.5,515.6875,881.5,511.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="553" x2="883.5" y1="511.6875" y2="511.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="560" y="506.8311">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="571" y="506.8311">sendEmail(invoice)</text><rect fill="#FFFFFF" filter="url(#f1gonokwd7yz26)" height="42.7031" style="stroke: #000000; stroke-width: 2.0;" width="126" x="842.5" y="549.6875"/><polygon fill="#EEEEEE" points="842.5,549.6875,904.5,549.6875,904.5,557.6875,894.5,567.6875,842.5,567.6875,842.5,549.6875" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="855.5" y="565.1826">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="848.5" y="585.1826">SD_CONNECTIONS</text><!--MD5=[668bdc2ce8d8ed40bdf37330e79e0dd7]
@startuml
autonumber
hide footbox

participant "GenerateInvoiceController" as CTRL
participant "invoiceServ\n:InvoiceService" as IS
participant "invoiceDB\n:InvoiceDB" as IDB
participant "invoice\n:Invoice" as I
participant "EmailSender" as E

[o-> CTRL : generateInvoice(order, mapPayments)
activate CTRL

CTRL -> IS** : create()
activate IS
IS -> IDB** : create()
deactivate IS

CTRL -> IS : invoice = addInvoice(order, mapPayments)
activate IS
IS -> I** : create(order, mapPayments)
deactivate IS

CTRL -> IS : registerInvoice(invoice)
activate IS
IS -> IDB : registerInvoice(invoice)
activate IDB
ref over IDB
SD_CONNECTIONS
end ref
deactivate IDB
deactivate IS

CTRL -> IS : sendEmail(invoice)
activate IS
IS -> E : sendEmail(invoice)
activate E
ref over E
SD_CONNECTIONS
end ref
deactivate E
deactivate IS
deactivate CTRL

@enduml

PlantUML version 1.2020.09(Sun May 10 11:51:06 BST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+8-b520.66
Operating System: Windows 10
Default Encoding: Cp1252
Language: pt
Country: PT
--></g></svg>