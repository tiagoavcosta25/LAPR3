@startuml
autonumber
hide footbox

actor "User" as U

participant "LoginUI" as UI
participant "LoginController" as CTRL


participant "userReg\n:UserRegistration" as UREG
participant "ApplicationPOT" as _APP
participant "app\n:ApplicationPOT" as APP
participant "session\n:UserSession" as SES
participant "plat\n:Platform" as PLAT
participant "user\n:User" as USER


participant "DataHandler" as DH

activate U

U -> UI : Engages the login feature/button
activate UI
UI --> U : Asks for all the email and password\nrequired for the login
deactivate UI

U -> UI : Fills all the information required and confirms
activate UI

UI -> CTRL : login(email,password)
activate CTRL

CTRL -> _APP: app = getInstance()
activate _APP
deactivate _APP

CTRL -> APP: plat = getPlaform()
activate APP
deactivate APP

CTRL -> PLAT : userReg = getUserReg()
activate PLAT
deactivate PLAT

CTRL -> UREG : login(email,password)
activate UREG

UREG -> USER** : create(email,password)

UREG -> UREG : checkIfUserExistsInDB(user)
ref over UREG
SD_CONNECTIONS
end ref

opt if the user exists in the DataBase and password corresponds

UREG -> _APP: app = getInstance()
activate _APP
deactivate _APP



UREG -> SES** : create(email)

UREG -> APP : setCurrentSession(session)


activate APP
deactivate APP

deactivate UREG


deactivate CTRL

UI --> U : Validates and allocates a session\n for the user
deactivate UI
end opt
deactivate U


@enduml